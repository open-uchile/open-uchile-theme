<%def name="online_help_token()"><% return "course" %></%def>
<%namespace name='static' file='static_content.html'/>
<%!
from django.utils.translation import ugettext as _
from datetime import datetime as dt
from django.urls import reverse
from six import text_type
import locale
from django.utils import timezone
now = timezone.now()
%>
<%
    if type(course["start"]) is str:
        course_start = dt.strptime(course["start"], "%Y-%m-%dT%H:%M:%S%z")
    else:
        course_start = course["start"]
    if type(course["end"]) is str:
        course_end = dt.strptime(course["end"], "%Y-%m-%dT%H:%M:%S%z")
    else:
        course_end = course["end"]
%>
<%
  card_class = ''
  if course_end is not None and now is not None and course_end < now:
    card_class = 'inactive'
%>

<%page args="course" expression_filter="h"/>
<div class="card h-100 mx-auto ${card_class}" style="background-image: url(${course['image_url']}), url(${static.url('open-uchile-theme/images/default-course.png')}); max-width: 400px;">
  <div class="card-body"></div>
  <div class="card-footer text-white">
      <span class="course-name"><strong>${course['display_name']}</strong></span>
      <br>
      <span class="course-org"><small>${course['org']}</small></span>
  </div>
  <div class="card-desc text-center text-white">
      <p class="font-weight-lighter font-italic">${course['short_description']}</p>
      <div class="card-button">
          <a href="${course['course_url']}"><button type="button" class="btn btn-outline-light">${_("See more")}</button></a>
      </div>
      
  </div>
  <div class="card-date">
      % if course_end is not None and now is not None and course_end < now:
          <div class="course-date" aria-hidden="true">${_("Finished course")}</div>
      % elif course_start is not None:
        %if course["self_paced"] and course_start <= now:
          <div class="course-date localized_datetime" aria-hidden="true" data-language="${LANGUAGE_CODE}" data-string='${_("Permanently open")}'></div>
       % else:
            %if "start_display" in course and course['start_display'] is not None:
                <div class="course-date localized_datetime" aria-hidden="true" data-language="${LANGUAGE_CODE}" data-string='${course["start_display"]}'></div>
            %else:
                <div class="course-date localized_datetime" aria-hidden="true" data-format="shortDate" data-datetime="${course_start}" data-language="${LANGUAGE_CODE}" data-string=""></div>
            %endif
       % endif
      % endif
  </div>
</div>
<%static:require_module_async module_name="js/dateutil_factory" class_name="DateUtilFactory">
    DateUtilFactory.transform(iterationKey=".localized_datetime");
</%static:require_module_async>
